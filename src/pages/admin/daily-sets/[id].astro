---
import Layout from "@/layouts/Layout.astro";
import { DailySetDetail } from "@/components/DailySetDetail";

export const prerender = false;

// Check authentication
const { user } = Astro.locals;

if (!user) {
  return Astro.redirect("/login?redirect=/admin/daily-sets");
}

// Check admin role
const { data: userData, error: userError } = await Astro.locals.supabase
  .from("users")
  .select("role")
  .eq("id", user.id)
  .single();

if (userError || !userData || userData.role !== "admin") {
  return Astro.redirect("/?error=unauthorized");
}

const { id } = Astro.params;
---

<Layout title="Daily Set Details" showNavigation={true}>
  <div class="min-h-screen bg-neutral-50 dark:bg-neutral-950">
    <div class="container mx-auto px-4 py-8 md:py-12">
      <div class="max-w-5xl mx-auto">
        <DailySetDetail client:load dailySetId={id} />
      </div>
    </div>
  </div>
</Layout>
